CREATE DATABASE RECEPTIONIST_PROCESS
GO
USE RECEPTIONIST_PROCESS
GO
----------T?O B?NG VÀ PRIMARY KEY----------
CREATE TABLE KHACHHANG
(
MAKH INT IDENTITY NOT NULL,
HOTENKH NVARCHAR(30) NOT NULL,
DCHI NVARCHAR(20) NOT NULL,
GIOITINH NVARCHAR(4) NOT NULL,
SDT INT UNIQUE NOT NULL, 
CMND INT UNIQUE NOT NULL, 
QUOCTICH NVARCHAR(20),
PRIMARY KEY (MAKH)
)
GO

--DROP TABLE PHONG
CREATE TABLE PHONG
(
MAPHONG NVARCHAR(10) NOT NULL,
TENPHONG CHAR (20) NOT NULL,
TINHTRANG NVARCHAR(15) NOT NULL,
MALOAIPHONG NVARCHAR(10),
GIAPHONG INT NOT NULL,
PRIMARY KEY (MAPHONG)
)
GO

CREATE TABLE LOAIPHONG
(
MALOAIPHONG NVARCHAR(10) NOT NULL,
TENLOAIPHONG NVARCHAR(10) NOT NULL,
SOLUONG INT NOT NULL,
TRANGBI NVARCHAR(100),
PRIMARY KEY (MALOAIPHONG)
)
GO

--DROP TABLE PHIEUDICHVU
CREATE TABLE PHIEUDICHVU
(
MAPHIEUDICHVU NVARCHAR(10) NOT NULL,
TENDICHVU NVARCHAR(20) NOT NULL,
GIA INT NOT NULL,
PRIMARY KEY (MAPHIEUDICHVU)
)
GO

CREATE TABLE NHANVIEN 
(
MANV INT NOT NULL,
TENNV NVARCHAR(20) NOT NULL,
GIOITINH VARCHAR(3) NOT NULL,
NSINH DATE DEFAULT GETDATE(),
SDT INT UNIQUE NOT NULL,
DCHI NVARCHAR(20) NOT NULL,
PRIMARY KEY (MANV)
)
GO

CREATE TABLE DATPHONG 
(
MAPHIEUDAT NVARCHAR(10) NOT NULL,
MAKH INT NOT NULL,
NGAYTAO DATE NOT NULL,
NGAYTRAPHONG DATE NOT NULL,
MAPHONG NVARCHAR(10) NOT NULL,
TRATRUOC INT,
MADICHVU NVARCHAR(10),
MANV INT NOT NULL,
PRIMARY KEY (MAPHIEUDAT)
)
GO
-- NGÀY THANH TOÁN B?NG NGÀY TR? PHÒNG
CREATE TABLE HOADON 
(
MAHOADON NVARCHAR(10) NOT NULL,
NGAYTHANHTOAN DATE NOT NULL,
MANV INT NOT NULL ,
MAPHIEUDATPHONG NVARCHAR(10) NOT NULL,
MADICHVU NVARCHAR(10),
TONGSOTIENPHAITRA INT NOT NULL,
PRIMARY KEY (MAHOADON)
)
GO
 
-- CHECK IN DATABASE 

ALTER TABLE KHACHHANG
ADD CONSTRAINT CK_KHACHHANG_GIOITINH CHECK
(GIOITINH=N'Nam' OR GIOITINH=N'N?');

ALTER TABLE NHANVIEN
ADD CONSTRAINT CK_NHANVIEN_GIOITINH CHECK
(GIOITINH=N'Nam' OR GIOITINH=N'N?'); --CHAY KO DC

ALTER TABLE PHONG
ADD CONSTRAINT CK_PHONG_TINHTRANG CHECK
(TINHTRANG='FULL' OR TINHTRANG='AVAILABLE');

ALTER TABLE PHONG
ADD CONSTRAINT CK_PHONG_GIAPHONG CHECK (GIAPHONG>=0);

ALTER TABLE PHIEUDICHVU
ADD CONSTRAINT CK_DICHVU_GIA CHECK (GIA>=0);

ALTER TABLE HOADON
ADD CONSTRAINT CK_HOADON_TONGTIEN CHECK (TONGSOTIENPHAITRA>=0);


-----------T?O FOREIGN KEY----------
--DROP CONSTRAINT FK_DATPHONG_PHONG;
ALTER TABLE DATPHONG  ADD CONSTRAINT FK_DATPHONG_PHONG 
FOREIGN KEY (MAPHONG) REFERENCES PHONG(MAPHONG)

ALTER TABLE DATPHONG  ADD CONSTRAINT FK_DATPHONG_KHACHHANG
FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH)

ALTER TABLE DATPHONG  ADD CONSTRAINT FK_DATPHONG_NHANVIEN
FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)

--DROP CONSTRAINT FK_PHONG_LOAIPHONG ;
ALTER TABLE PHONG  ADD CONSTRAINT FK_PHONG_LOAIPHONG 
FOREIGN KEY (MALOAIPHONG) REFERENCES LOAIPHONG(MALOAIPHONG)

ALTER TABLE HOADON  ADD CONSTRAINT FK_HOADON_NHANVIEN
FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)

ALTER TABLE HOADON  ADD CONSTRAINT FK_HOADON_DATPHONG
FOREIGN KEY (MAPHIEUDATPHONG) REFERENCES DATPHONG(MAPHIEUDAT)

ALTER TABLE HOADON  ADD CONSTRAINT FK_HOADON_PHIEUDICHVU
FOREIGN KEY (MADICHVU) REFERENCES PHIEUDICHVU(MAPHIEUDICHVU)

ALTER TABLE DATPHONG ADD CONSTRAINT FK_DATPHONG_PHIEUDICHVU
FOREIGN KEY (MADICHVU) REFERENCES PHIEUDICHVU(MAPHIEUDICHVU)

SET IDENTITY_INSERT KHACHHANG ON;
SET IDENTITY_INSERT HOADON ON;
SET IDENTITY_INSERT NHANVIEN ON;
SET IDENTITY_INSERT DATPHONG ON;
SET IDENTITY_INSERT PHIEUDICHVU ON;
SET IDENTITY_INSERT PHONG ON;
SET IDENTITY_INSERT LOAIPHONG ON;


----------T?O THÔNG TIN ?? TRUY V?N----------
SELECT *FROM KHACHHANG
INSERT INTO KHACHHANG (MAKH, HOTENKH, DCHI, GIOITINH, SDT, CMND, QUOCTICH)
VALUES
(001, N'Nguy?n Th? Kim Quyên', N'Long An', N'N?', 0352251421, 053000478, N'Vi?t Nam'),
(002, N'Nguy?n M?nh Hùng', N'B?n Tre', N'Nam', 0913055113, 053000123, N'Vi?t Nam'),
(003, N'Nguy?n Nh?t Tr??ng', N'Cà Mau', N'Nam', 0584866644, 053000598, N'Vi?t Nam'),
(004, N'Ph?m Thanh H?ng', N'Tây Ninh', N'N?', 0347856876, 053000452, N'Vi?t Nam'),
(005, N'Tr?n Tu?n Minh', N'Tp.H? Chí Minh', N'Nam', 0598388093, 053000693, N'Vi?t Nam'),
(006, N'Nguy?n Th? Nh? Qu?nh', N'B?c Ninh', N'N?', 0917936773, 053000119, N'Vi?t Nam'),
(007, N'Tôn N? Thanh Tuy?n', N'Long An', N'N?', 0931891477, 053000456, N'Vi?t Nam'),
(008, N'Lê Thanh Xuân', N'Tp.H? Chí Minh', N'Nam', 0896163663, 053000978, N'Vi?t Nam'),
(009, N'Phan Qu?c Vinh', N'Hà N?i', N'Nam', 0248880359, 053000790, N'Vi?t Nam'),
(010, N'??ng Th? Ng?c Hoa', N'?à N?ng', N'N?', 0932488962, 053000677, N'Vi?t Nam')

SELECT * FROM PHONG
DELETE FROM PHONG
INSERT INTO PHONG(MAPHONG, TENPHONG, TINHTRANG, MALOAIPHONG, GIAPHONG)
VALUES 
(881, 'A01', 'AVAILABLE', '991', 600000),
(882, 'A02', 'AVAILABLE', '991', 600000),
(883, 'A03', 'AVAILABLE', '991', 600000),
(884, 'A04', 'AVAILABLE', '991', 600000),
(885, 'A05', 'AVAILABLE', '991', 600000),
(886, 'A05', 'AVAILABLE', '991', 600000),
(887, 'A06', 'AVAILABLE', '991', 600000),
(888, 'A07', 'AVAILABLE', '991', 600000),
(889, 'A08', 'AVAILABLE', '991', 600000),
(890, 'B01', 'AVAILABLE', '992', 840000),
(891, 'B02', 'AVAILABLE', '992', 840000),
(892, 'B03', 'AVAILABLE', '992', 840000),
(893, 'B04', 'AVAILABLE', '992', 840000),
(894, 'B05', 'AVAILABLE', '992', 840000),
(895, 'B06', 'AVAILABLE', '992', 840000),
(896, 'B07', 'AVAILABLE', '992', 840000),
(897, 'C01', 'AVAILABLE', '993', 3000000),
(898, 'C02', 'AVAILABLE', '993', 3000000),
(899, 'C03', 'AVAILABLE', '993', 3000000),
(900, 'C04', 'AVAILABLE', '993', 3000000),
(901, 'C05', 'AVAILABLE', '993', 3000000)

SELECT * FROM LOAIPHONG
INSERT INTO LOAIPHONG(MALOAIPHONG, TENLOAIPHONG, SOLUONG, TRANGBI)
VALUES
(991, 'Standard', 8, N'Di?n tích 13-16m2, gi??ng ?ôi, máy l?nh, k? tivi, phòng t?m, t?'),
(992, 'Superior', 7, N'Di?n tích 16-18m2, gi??ng ?ôi, máy l?nh, k? ti vi, phòng t?m, t?, sofa, bàn làm vi?c'),
(993, 'Deluxe', 5, N'Di?n tích 32-36m2, có nhi?u phòng, ??y ?? ti?n nghi, view h??ng ra bi?n, núi')

--DELETE FROM PHIEUDICHVU
SELECT * FROM PHIEUDICHVU
INSERT INTO PHIEUDICHVU (MAPHIEUDICHVU, TENDICHVU, GIA)
VALUES
('VU01', N'Gi?t ?i', 100000),
('VU02', N'Gym', 200000),
('VU03', N'Spa', 200000),
('VU04', N'Karaoke', 300000),
('VU05', N'Thuê xe', 200000),
('VU06', N'Trông tr?', 100000),
('VU07', N'Casino', 300000),
('VU08', N'Th? thao', 200000),
('VU09', N'Ph?c v? 24/24', 500000),
('VU10', N'??t vé', 100000)

DELETE FROM NHANVIEN
SELECT * FROM NHANVIEN
INSERT INTO NHANVIEN(MANV, TENNV, GIOITINH, NSINH, SDT, DCHI)
VALUES
(111, N'Di?m Thuy', N'N?', '2003-10-01', 0783651179, N'Long An'),
(112, N'M? Duyên', N'N?', '1986-09-14', 0933563217, N'Tp.H? Chí Minh'),
(113, N'T?n Phát', N'Nam', '2001-12-24', 0775610840,N'Tp.H? Chí Minh'),
(114, N'Thu Trang', N'N?', '1999-06-01', 0249954553, N'Tây Ninh'),
(115, N'M? Tiên', N'N?', '1993-09-21', 0909989055, N'Bình D??ng'),
(116, N'Phát ??t', N'Nam', '2004-10-23', 0784961169, N'??ng Nai'),
(117, N'Tu?n C??ng', N'Nam', '1994-10-26', 0916055119, N'Qu?ng Ng?i'),
(118, N'Nh? Ý', N'N?', '1998-11-01', 0933567017, N'Hà N?i'),
(119, N'Th?o Mai', N'N?', '1997-02-04', 0915088666, N'Cà Mau'),
(120, N'Duy H?i', N'Nam', '1995-07-26', 0763671179, N'Hà T?nh')

--DELETE FROM DATPHONG
SELECT * FROM DATPHONG
INSERT INTO DATPHONG(MAPHIEUDAT, MAKH, NGAYTAO, NGAYTRAPHONG, MAPHONG, TRATRUOC, MADICHVU, MANV)
VALUES
('PD1', 001, '2023-02-14 ', '2023-02-20', 881, 200000, NULL, 116),
('PD2', 002, '2023-04-30', '2023-05-05', 901, 1000000, 'VU05', 112),
('PD3', 003, '2023-02-11', '2023-02-13', 889, 300000, 'VU01', 116),
('PD4', 004, '2023-03-19', '2023-03-20', 883, 200000, 'VU02', 114),
('PD5', 005, '2023-02-28', '2023-03-03', 894, 300000, 'VU07', 115),
('PD6', 006, '2023-03-01', '2023-03-10', 900, 1000000, 'VU06', 111),
('PD7', 007, '2023-03-01', '2023-03-09', 885, 200000, NULL, 111),
('PD8', 008, '2023-02-11', '2023-02-19', 886, 200000, 'VU03', 114),
('PD9', 009, '2023-03-01', '2023-03-04', 895, 300000, 'VU04', 115),
('PD10', 010,'2023-04-02', '2023-04-04', 882, 200000, NULL, 115),
('PD11', 005, '2023-02-28', '2023-03-03', 887, 600000, 'VU10', 113),
('PD12', 001, '2023-02-14 ', '2023-02-20', 899, 1000000, 'VU09', 115)

SELECT * FROM HOADON
INSERT INTO HOADON(MAHOADON, MAPHIEUDATPHONG, MANV, NGAYTHANHTOAN, MADICHVU, TONGSOTIENPHAITRA)
VALUES
('HD1', 'PD1', 116, '2023-02-20', NULL, 600000),
('HD2', 'PD2', 112, '2023-04-30', 'VU05', 3200000),
('HD3', 'PD3', 116, '2023-02-13', 'VU01', 850000),
('HD4', 'PD4', 114,  '2023-03-20', 'VU02', 800000),
('HD5', 'PD5', 115,  '2023-03-03', 'VU07', 1140000),
('HD6', 'PD6', 111,  '2023-03-01', 'VU06', 3100000),
('HD7', 'PD7', 111,  '2023-03-09', NULL, 600000),
('HD8', 'PD8', 114,  '2023-02-19', 'VU03', 800000),
('HD9', 'PD9', 115, '2023-03-04', 'VU04', 1140000),
('HD10','PD10', 115, '2023-04-04', NULL, 600000),
('HD11', 'PD11', 113, '2023-02-28', 'VU10', 850000),
('HD12', 'PD12', 115, '2023-02-20', 'VU09', 3500000)